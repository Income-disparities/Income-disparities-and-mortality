<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>openMetaAnalysis: PICO Table</title>
<script src="//code.jquery.com/jquery-2.1.1.js"></script>
<script src="/openmetaanalysis.js"></script>
<script src="/tables.js"></script>
<link rel="stylesheet" href="/openmetaanalysis.css">
<script>
//put this all in a central file!
$(document).ready(function(){
var url = "/template/tables/pico.xml";
        $.ajax({
            type: "GET",
            url: url,
            cache: false,
            dataType: "xml",
            error: function() {
                alert("The XML File could not be processed correctly.");
                },
            success: function(xml) { 
			$("#list").text('');
			$(xml).find('study').each(function(){
                        	var pmid= $(this).find("citation").attr("pmid");
				$("#list").append("<li>" + $(this).find("citation").attr("journal_abbrev") + ". " + $(this).find("citation").attr("year") + " PMID: <a href='http://pubmed.gov/" + pmid + "'>" + pmid + "</a>")
				$("#list").append('<ul>')
                	        $(this).find('patients').each(function(){
					var bullet = $(this).find('bullet').text();
					$("#list").append('<li>' + bullet + '</li>');
					})
				$("#list").append('</ul>')
				$("#list").append('</li>')
				
				var trHTML += '<tr><td>' + pmid + '</td><td>' + $(this).find('patients').text() + '</td><td>' + $(this).find('intervention').text() + '</td><td>' + $(this).find('control').text() + '</td><td>' + $(this).find('outcome').text() + '</td></tr>';
			        $('#citations').append(trHTML);
				
			})
                }
      });
    });
</script>
</head>
<body>

<h1>openMetaAnalysis: PICO Table</h1>
<h2><span class="repo_name"></span></h2>

<a href="index.html">Return to summary</a>

<div class="header_panel" id="header_pico"></div>
<div class="body_panel">
<table id="citations">
</table>

<ul id="list" data-role="listview" data-theme="a" data-filter="true">
<li id="load">Loading Data...</li>
</ul>

</body>
</html>
